shadow$provide[398]=function(r,l,A,p){var k=l(209),m=l(214),d=l(346),c=l(395),a=l(396),b=l(397);l(394);var e=l(392),g=l(391);const f=[],h=[],n=[];r=(()=>{const q=class extends m.Container{constructor(t,u={}){super();const {align:v,tint:x,maxWidth:z,letterSpacing:y,fontName:C,fontSize:B}=Object.assign({},q.styleDefaults,u);if(!c.BitmapFont.available[C])throw Error(`Missing BitmapFont "${C}"`);this._activePagesMeshData=[];this._textHeight=this._textWidth=0;this._align=v;this._tintColor=new k.Color(x);
this._font=void 0;this._fontName=C;this._fontSize=B;this.text=t;this._maxWidth=z;this._maxLineHeight=0;this._letterSpacing=y;this._anchor=new k.ObservablePoint(()=>{this.dirty=!0},this,0,0);this._roundPixels=k.settings.ROUND_PIXELS;this.dirty=!0;this._resolution=k.settings.RESOLUTION;this._autoResolution=!0;this._textureCache={}}updateText(){const t=c.BitmapFont.available[this._fontName];var u=this.fontSize,v=u/t.size,x=new k.Point;const z=[];var y=[],C=[],B=this._text.replace(/(?:\r\n|\r)/g,"\n")||
" ",w=e.splitTextToCharacters(B),E=this._maxWidth*t.size/u,H="none"===t.distanceFieldType?f:h;let I=null;var M=0,N=B=0,G=-1,K=0,D=0,F=u=0;for(let S=0;S<w.length;S++){var J=w[S];const U=g.extractCharCode(J);if(/(?:\s)/.test(J)&&(G=S,K=M,F++),"\r"===J||"\n"===J)y.push(M),C.push(-1),B=Math.max(B,M),++N,++D,x.x=0,x.y+=t.lineHeight,I=null,F=0;else if(J=t.chars[U])I&&J.kerning[I]&&(x.x+=J.kerning[I]),M=n.pop()||{texture:k.Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new k.Point},M.texture=J.texture,
M.line=N,M.charCode=U,M.position.x=Math.round(x.x+J.xOffset+this._letterSpacing/2),M.position.y=Math.round(x.y+J.yOffset),M.prevSpaces=F,z.push(M),M=M.position.x+Math.max(J.xAdvance-J.xOffset,J.texture.orig.width),x.x+=J.xAdvance+this._letterSpacing,u=Math.max(u,J.yOffset+J.texture.height),I=U,-1!==G&&0<E&&x.x>E&&(++D,k.utils.removeItems(z,1+G-D,1+S-G),S=G,G=-1,y.push(K),C.push(0<z.length?z[z.length-1].prevSpaces:0),B=Math.max(B,K),N++,x.x=0,x.y+=t.lineHeight,I=null,F=0)}w=w[w.length-1];"\r"!==w&&
"\n"!==w&&(/(?:\s)/.test(w)&&(M=K),y.push(M),B=Math.max(B,M),C.push(-1));w=[];for(K=0;K<=N;K++)E=0,"right"===this._align?E=B-y[K]:"center"===this._align?E=(B-y[K])/2:"justify"===this._align&&(E=0>C[K]?0:(B-y[K])/C[K]),w.push(E);C=z.length;y={};N=[];K=this._activePagesMeshData;H.push(...K);for(E=0;E<C;E++){M=z[E].texture;G=M.baseTexture.uid;if(!y[G]){D=H.pop();if(!D){D=new d.MeshGeometry;var L=void 0,R=void 0;"none"===t.distanceFieldType?(L=new d.MeshMaterial(k.Texture.EMPTY),R=k.BLEND_MODES.NORMAL):
(L=new d.MeshMaterial(k.Texture.EMPTY,{program:k.Program.from(b.default,a.default),uniforms:{uFWidth:0}}),R=k.BLEND_MODES.NORMAL_NPM);D=new d.Mesh(D,L);D.blendMode=R;D={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:D,vertices:null,uvs:null,indices:null}}D.index=0;D.indexCount=0;D.vertexCount=0;D.uvsCount=0;D.total=0;({_textureCache:F}=this);F[G]=F[G]||new k.Texture(M.baseTexture);D.mesh.texture=F[G];D.mesh.tint=this._tintColor.value;N.push(D);y[G]=D}y[G].total++}for(L=0;L<K.length;L++)N.includes(K[L])||
this.removeChild(K[L].mesh);for(L=0;L<N.length;L++)N[L].mesh.parent!==this&&this.addChild(N[L].mesh);this._activePagesMeshData=N;for(var O in y){L=y[O];R=L.total;if(!(L.indices?.length>6*R)||L.vertices.length<2*d.Mesh.BATCHABLE_SIZE)L.vertices=new Float32Array(8*R),L.uvs=new Float32Array(8*R),L.indices=new Uint16Array(6*R);else for(N=L.total,H=L.vertices,N*=8;N<H.length;N++)H[N]=0;L.mesh.size=6*R}for(O=0;O<C;O++)H=z[O],L=H.position.x+w[H.line]*("justify"===this._align?H.prevSpaces:1),this._roundPixels&&
(L=Math.round(L)),L*=v,R=H.position.y*v,K=H.texture,H=y[K.baseTexture.uid],N=K.frame,K=K._uvs,E=H.index++,H.indices[6*E]=4*E,H.indices[6*E+1]=1+4*E,H.indices[6*E+2]=2+4*E,H.indices[6*E+3]=4*E,H.indices[6*E+4]=2+4*E,H.indices[6*E+5]=3+4*E,H.vertices[8*E]=L,H.vertices[8*E+1]=R,H.vertices[8*E+2]=L+N.width*v,H.vertices[8*E+3]=R,H.vertices[8*E+4]=L+N.width*v,H.vertices[8*E+5]=R+N.height*v,H.vertices[8*E+6]=L,H.vertices[8*E+7]=R+N.height*v,H.uvs[8*E]=K.x0,H.uvs[8*E+1]=K.y0,H.uvs[8*E+2]=K.x1,H.uvs[8*E+3]=
K.y1,H.uvs[8*E+4]=K.x2,H.uvs[8*E+5]=K.y2,H.uvs[8*E+6]=K.x3,H.uvs[8*E+7]=K.y3;this._textWidth=B*v;this._textHeight=(x.y+t.lineHeight)*v;for(const S in y){x=y[S];if(0!==this.anchor.x||0!==this.anchor.y)for(B=0,O=this._textWidth*this.anchor.x,w=this._textHeight*this.anchor.y,L=0;L<x.total;L++)x.vertices[B++]-=O,x.vertices[B++]-=w,x.vertices[B++]-=O,x.vertices[B++]-=w,x.vertices[B++]-=O,x.vertices[B++]-=w,x.vertices[B++]-=O,x.vertices[B++]-=w;this._maxLineHeight=u*v;B=x.mesh.geometry.getBuffer("aVertexPosition");
O=x.mesh.geometry.getBuffer("aTextureCoord");w=x.mesh.geometry.getIndex();B.data=x.vertices;O.data=x.uvs;w.data=x.indices;B.update();O.update();w.update()}for(v=0;v<z.length;v++)n.push(z[v]);this._font=t;this.dirty=!1}updateTransform(){this.validate();this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const {distanceFieldRange:u,distanceFieldType:v,size:x}=c.BitmapFont.available[this._fontName];if("none"!==
v){const {a:z,b:y,c:C,d:B}=this.worldTransform,w=(Math.abs(Math.sqrt(z*z+y*y))+Math.abs(Math.sqrt(C*C+B*B)))/2,E=this.fontSize/x,H=t._view.resolution;for(const I of this._activePagesMeshData)I.mesh.shader.uniforms.uFWidth=w*u*E*H}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=c.BitmapFont.available[this._fontName];if(!t)throw Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0);this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==
t){this._tintColor.setValue(t);for(let u=0;u<this._activePagesMeshData.length;u++)this._activePagesMeshData[u].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!c.BitmapFont.available[t])throw Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??c.BitmapFont.available[this._fontName].size}set fontSize(t){this._fontSize!==
t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??"");this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==
t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1;this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const {_textureCache:u}=this,v="none"===c.BitmapFont.available[this._fontName].distanceFieldType?f:h;v.push(...this._activePagesMeshData);
for(const x of this._activePagesMeshData)this.removeChild(x.mesh);this._activePagesMeshData=[];v.filter(x=>u[x.mesh.texture.baseTexture.uid]).forEach(x=>{x.mesh.texture=k.Texture.EMPTY});for(const x in u)u[x].destroy(),delete u[x];this._textureCache=this._tintColor=this._font=null;super.destroy(t)}};return q})();r.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};p.BitmapText=r}
goog.provide("module$node_modules$$pixi$text_bitmap$lib$BitmapText");
goog.global. module$node_modules$$pixi$text_bitmap$lib$BitmapText=shadow.js.require(398, {});
