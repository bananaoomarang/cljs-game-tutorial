shadow$provide[403]=function(r,l,A,p){var k=l(209);r=l(216);var m=l(364),d=l(402);const c=class extends r.Sprite{constructor(a="",b={}){super(k.Texture.EMPTY);this._style=this._text=null;this._autoResolution=!0;this.localStyleID=-1;this.dirty=!1;this._updateID=0;this.ownsStyle=!1;const e=new Image;var g=k.Texture.from(e,{scaleMode:k.settings.SCALE_MODE,resourceOptions:{autoLoad:!1}});g.orig=new k.Rectangle;g.trim=new k.Rectangle;this.texture=g;g=document.createElementNS("http://www.w3.org/2000/svg",
"svg");const f=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),h=document.createElementNS("http://www.w3.org/1999/xhtml","div"),n=document.createElementNS("http://www.w3.org/1999/xhtml","style");f.setAttribute("width","10000");f.setAttribute("height","10000");f.style.overflow="hidden";g.appendChild(f);this.maxWidth=c.defaultMaxWidth;this.maxHeight=c.defaultMaxHeight;this._domElement=h;this._styleElement=n;this._svgRoot=g;this._foreignObject=f;this._foreignObject.appendChild(n);
this._foreignObject.appendChild(h);this._image=e;this._loadImage=new Image;this._autoResolution=c.defaultAutoResolution;this._resolution=c.defaultResolution??k.settings.RESOLUTION;this.text=a;this.style=b}measureText(a){const {text:b,style:e,resolution:g}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},a);Object.assign(this._domElement,{innerHTML:b,style:e.toCSS(g)});this._styleElement.textContent=e.toGlobalCSS();document.body.appendChild(this._svgRoot);a=this._domElement.getBoundingClientRect();
this._svgRoot.remove();const {width:f,height:h}=a;(f>this.maxWidth||h>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");a=Math.min(this.maxWidth,Math.ceil(f));const n=Math.min(this.maxHeight,Math.ceil(h));return this._svgRoot.setAttribute("width",a.toString()),this._svgRoot.setAttribute("height",n.toString()),b!==this._text&&(this._domElement.innerHTML=this._text),e!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(g)}),
this._styleElement.textContent=this._style?.toGlobalCSS()),{width:a+2*e.padding,height:n+2*e.padding}}async updateText(a=!0){const {style:b,_image:e,_loadImage:g}=this;if(this.localStyleID!==b.styleID&&(this.dirty=!0,this.localStyleID=b.styleID),this.dirty||!a){var {width:f,height:h}=this.measureText();e.width=g.width=Math.ceil(Math.max(1,f));e.height=g.height=Math.ceil(Math.max(1,h));this._updateID++;var n=this._updateID;await new Promise(q=>{g.onload=async()=>{n<this._updateID||(await b.onBeforeDraw(),
e.src=g.src,g.onload=null,g.src="",this.updateTexture());q()};const t=(new XMLSerializer).serializeToString(this._svgRoot);g.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(t)}`})}}get source(){return this._image}updateTexture(){const {style:a,texture:b,_image:e,resolution:g}=this,{padding:f}=a,{baseTexture:h}=b;b.trim.width=b._frame.width=e.width/g;b.trim.height=b._frame.height=e.height/g;b.trim.x=-f;b.trim.y=-f;b.orig.width=b._frame.width-2*f;b.orig.height=b._frame.height-2*f;this._onTextureUpdate();
h.setRealSize(e.width,e.height,g);this.dirty=!1}_render(a){this._autoResolution&&this._resolution!==a.resolution&&(this._resolution=a.resolution,this.dirty=!0);this.updateText(!0);super._render(a)}_renderCanvas(a){this._autoResolution&&this._resolution!==a.resolution&&(this._resolution=a.resolution,this.dirty=!0);this.updateText(!0);super._renderCanvas(a)}getLocalBounds(a){return this.updateText(!0),super.getLocalBounds(a)}_calculateBounds(){this.updateText(!0);this.calculateVertices();this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=
!0}destroy(a){"boolean"==typeof a&&(a={children:a});a=Object.assign({},c.defaultDestroyOptions,a);super.destroy(a);this.ownsStyle&&this._style?.cleanFonts();this._style=null;this._svgRoot?.remove();this._svgRoot=null;this._domElement?.remove();this._domElement=null;this._foreignObject?.remove();this._foreignObject=null;this._styleElement?.remove();this._styleElement=null;this._loadImage.src="";this._loadImage=this._loadImage.onload=null;this._image.src="";this._image=null}get width(){return this.updateText(!0),
Math.abs(this.scale.x)*this._image.width/this.resolution}set width(a){this.updateText(!0);const b=k.utils.sign(this.scale.x)||1;this.scale.x=b*a/this._image.width/this.resolution;this._width=a}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(a){this.updateText(!0);const b=k.utils.sign(this.scale.y)||1;this.scale.y=b*a/this._image.height/this.resolution;this._height=a}get style(){return this._style}set style(a){this._style!==a&&(a=a||{},a instanceof
d.HTMLTextStyle?(this.ownsStyle=!1,this._style=a):a instanceof m.TextStyle?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=d.HTMLTextStyle.from(a)):(this.ownsStyle=!0,this._style=new d.HTMLTextStyle(a)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(a){a=String(""===a||null===a||void 0===a?" ":a);a=this.sanitiseText(a);this._text!==a&&(this._text=a,this.dirty=!0)}get resolution(){return this._resolution}set resolution(a){this._autoResolution=
!1;this._resolution!==a&&(this._resolution=a,this.dirty=!0)}sanitiseText(a){return a.replace(/<br>/gi,"\x3cbr/\x3e").replace(/<hr>/gi,"\x3chr/\x3e").replace(/&nbsp;/gi,"\x26#160;")}};l=c;l.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};l.defaultMaxWidth=2024;l.defaultMaxHeight=2024;l.defaultAutoResolution=!0;p.HTMLText=l}
goog.provide("module$node_modules$$pixi$text_html$lib$HTMLText");
goog.global. module$node_modules$$pixi$text_html$lib$HTMLText=shadow.js.require(403, {});
