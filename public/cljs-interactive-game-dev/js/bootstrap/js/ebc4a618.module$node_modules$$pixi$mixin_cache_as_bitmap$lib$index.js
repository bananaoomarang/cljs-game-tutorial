shadow$provide[217]=function(r,l,A,p){var k=l(209);r=l(214);var m=l(216);const d=new k.Matrix;r.DisplayObject.prototype._cacheAsBitmap=!1;r.DisplayObject.prototype._cacheData=null;r.DisplayObject.prototype._cacheAsBitmapResolution=null;r.DisplayObject.prototype._cacheAsBitmapMultisample=null;class c{constructor(){this.sprite=this.originalContainsPoint=this.originalFilterArea=this.originalMask=this.originalDestroy=this.originalUpdateTransform=this.originalGetLocalBounds=this.originalCalculateBounds=
this.originalRenderCanvas=this.originalRender=this.textureCacheId=null}}Object.defineProperties(r.DisplayObject.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(a){a!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=a,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(a){a!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=a,this.cacheAsBitmap&&
(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(a){if(this._cacheAsBitmap!==a){this._cacheAsBitmap=a;var b;a?(this._cacheData||(this._cacheData=new c),b=this._cacheData,b.originalRender=this.render,b.originalRenderCanvas=this.renderCanvas,b.originalUpdateTransform=this.updateTransform,b.originalCalculateBounds=this.calculateBounds,b.originalGetLocalBounds=this.getLocalBounds,b.originalDestroy=this.destroy,b.originalContainsPoint=this.containsPoint,
b.originalMask=this._mask,b.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(b=this._cacheData,b.sprite&&this._destroyCachedDisplayObject(),this.render=b.originalRender,this.renderCanvas=b.originalRenderCanvas,this.calculateBounds=b.originalCalculateBounds,this.getLocalBounds=b.originalGetLocalBounds,this.destroy=b.originalDestroy,this.updateTransform=b.originalUpdateTransform,this.containsPoint=
b.originalContainsPoint,this._mask=b.originalMask,this.filterArea=b.originalFilterArea)}}}});r.DisplayObject.prototype._renderCached=function(a){!this.visible||0>=this.worldAlpha||!this.renderable||(this._initCachedDisplayObject(a),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(a))};r.DisplayObject.prototype._initCachedDisplayObject=function(a){if(!this._cacheData?.sprite){var b=this.alpha;this.alpha=
1;a.batch.flush();var e=this.getLocalBounds(new k.Rectangle,!0);this.filters?.length&&e.pad(this.filters[0].padding);var g=this.cacheAsBitmapResolution||a.resolution;e.ceil(g);e.width=Math.max(e.width,1/g);e.height=Math.max(e.height,1/g);var f=a.renderTexture.current,h=a.renderTexture.sourceFrame.clone(),n=a.renderTexture.destinationFrame.clone(),q=a.projection.transform;g=k.RenderTexture.create({width:e.width,height:e.height,resolution:g,multisample:this.cacheAsBitmapMultisample??a.multisample});
var t=`cacheAsBitmap_${k.utils.uid()}`;this._cacheData.textureCacheId=t;k.BaseTexture.addToCache(g.baseTexture,t);k.Texture.addToCache(g,t);t=this.transform.localTransform.copyTo(d).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender;a.render(this,{renderTexture:g,clear:!0,transform:t,skipUpdateTransform:!1});a.framebuffer.blit();a.projection.transform=q;a.renderTexture.bind(f,h,n);this.render=this._renderCached;this.updateTransform=this.displayObjectUpdateTransform;this.calculateBounds=
this._calculateCachedBounds;this.getLocalBounds=this._getCachedLocalBounds;this.filterArea=this._mask=null;this.alpha=b;a=new m.Sprite(g);a.transform.worldTransform=this.transform.worldTransform;a.anchor.x=-(e.x/e.width);a.anchor.y=-(e.y/e.height);a.alpha=b;a._bounds=this._bounds;this._cacheData.sprite=a;this.transform._parentID=-1;this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null));this.containsPoint=a.containsPoint.bind(a)}};r.DisplayObject.prototype._renderCachedCanvas=
function(a){!this.visible||0>=this.worldAlpha||!this.renderable||(this._initCachedDisplayObjectCanvas(a),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(a))};r.DisplayObject.prototype._initCachedDisplayObjectCanvas=function(a){if(!this._cacheData?.sprite){var b=this.getLocalBounds(new k.Rectangle,!0),e=this.alpha;this.alpha=1;var g=a.canvasContext.activeContext,f=a._projTransform,h=this.cacheAsBitmapResolution||a.resolution;b.ceil(h);b.width=Math.max(b.width,
1/h);b.height=Math.max(b.height,1/h);h=k.RenderTexture.create({width:b.width,height:b.height,resolution:h});var n=`cacheAsBitmap_${k.utils.uid()}`;this._cacheData.textureCacheId=n;k.BaseTexture.addToCache(h.baseTexture,n);k.Texture.addToCache(h,n);this.transform.localTransform.copyTo(d);d.invert();d.tx-=b.x;d.ty-=b.y;this.renderCanvas=this._cacheData.originalRenderCanvas;a.render(this,{renderTexture:h,clear:!0,transform:d,skipUpdateTransform:!1});a.canvasContext.activeContext=g;a._projTransform=f;
this.renderCanvas=this._renderCachedCanvas;this.updateTransform=this.displayObjectUpdateTransform;this.calculateBounds=this._calculateCachedBounds;this.getLocalBounds=this._getCachedLocalBounds;this.filterArea=this._mask=null;this.alpha=e;g=new m.Sprite(h);g.transform.worldTransform=this.transform.worldTransform;g.anchor.x=-(b.x/b.width);g.anchor.y=-(b.y/b.height);g.alpha=e;g._bounds=this._bounds;this._cacheData.sprite=g;this.transform._parentID=-1;this.parent?this.updateTransform():(this.parent=
a._tempDisplayObjectParent,this.updateTransform(),this.parent=null);this.containsPoint=g.containsPoint.bind(g)}};r.DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear();this._cacheData.sprite.transform._worldID=this.transform._worldID;this._cacheData.sprite._calculateBounds();this._bounds.updateID=this._boundsID};r.DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};r.DisplayObject.prototype._destroyCachedDisplayObject=
function(){this._cacheData.sprite._texture.destroy(!0);this._cacheData.sprite=null;k.BaseTexture.removeFromCache(this._cacheData.textureCacheId);k.Texture.removeFromCache(this._cacheData.textureCacheId);this._cacheData.textureCacheId=null};r.DisplayObject.prototype._cacheAsBitmapDestroy=function(a){this.cacheAsBitmap=!1;this.destroy(a)};p.CacheData=c}
goog.provide("module$node_modules$$pixi$mixin_cache_as_bitmap$lib$index");
goog.global. module$node_modules$$pixi$mixin_cache_as_bitmap$lib$index=shadow.js.require(217, {});
