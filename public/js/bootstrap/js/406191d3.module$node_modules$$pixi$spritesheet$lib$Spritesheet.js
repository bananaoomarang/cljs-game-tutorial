shadow$provide[381]=function(r,l,A,p){var k=l(209);const m=class{constructor(d,c,a){this.linkedSheets=[];(d instanceof k.BaseTexture||d instanceof k.Texture)&&(d={texture:d,data:c,resolutionFilename:a});const {texture:b,data:e,resolutionFilename:g=null,cachePrefix:f=""}=d;this.cachePrefix=f;this._texture=b instanceof k.Texture?b:null;this.baseTexture=b instanceof k.BaseTexture?b:this._texture.baseTexture;this.textures={};this.animations={};this.data=e;d=this.baseTexture.resource;this.resolution=this._updateResolution(g||
(d?d.url:null));this._frames=this.data.frames;this._frameKeys=Object.keys(this._frames);this._batchIndex=0;this._callback=null}_updateResolution(d=null){const {scale:c}=this.data.meta;d=k.utils.getResolutionOfUrl(d,null);return null===d&&(d="number"==typeof c?c:parseFloat(c??"1")),1!==d&&this.baseTexture.setResolution(d),d}parse(){return new Promise(d=>{this._callback=d;this._batchIndex=0;this._frameKeys.length<=m.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):
this._nextBatch()})}_processFrames(d){let c=d;const a=m.BATCH_SIZE;for(;c-d<a&&c<this._frameKeys.length;){const e=this._frameKeys[c],g=this._frames[e],f=g.frame;if(f){let h=null,n=null;var b=!1!==g.trimmed&&g.sourceSize?g.sourceSize:g.frame;b=new k.Rectangle(0,0,Math.floor(b.w)/this.resolution,Math.floor(b.h)/this.resolution);g.rotated?h=new k.Rectangle(Math.floor(f.x)/this.resolution,Math.floor(f.y)/this.resolution,Math.floor(f.h)/this.resolution,Math.floor(f.w)/this.resolution):h=new k.Rectangle(Math.floor(f.x)/
this.resolution,Math.floor(f.y)/this.resolution,Math.floor(f.w)/this.resolution,Math.floor(f.h)/this.resolution);!1!==g.trimmed&&g.spriteSourceSize&&(n=new k.Rectangle(Math.floor(g.spriteSourceSize.x)/this.resolution,Math.floor(g.spriteSourceSize.y)/this.resolution,Math.floor(f.w)/this.resolution,Math.floor(f.h)/this.resolution));this.textures[e]=new k.Texture(this.baseTexture,h,b,n,g.rotated?2:0,g.anchor,g.borders);k.Texture.addToCache(this.textures[e],this.cachePrefix+e.toString())}c++}}_processAnimations(){const d=
this.data.animations||{};for(const c in d){this.animations[c]=[];for(let a=0;a<d[c].length;a++)this.animations[c].push(this.textures[d[c][a]])}}_parseComplete(){const d=this._callback;this._callback=null;this._batchIndex=0;d.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*m.BATCH_SIZE);this._batchIndex++;setTimeout(()=>{this._batchIndex*m.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(d=!1){for(const c in this.textures)this.textures[c].destroy();
this.textures=this.data=this._frameKeys=this._frames=null;d&&(this._texture?.destroy(),this.baseTexture.destroy());this.baseTexture=this._texture=null;this.linkedSheets=[]}};r=m;r.BATCH_SIZE=1E3;p.Spritesheet=r}
goog.provide("module$node_modules$$pixi$spritesheet$lib$Spritesheet");
goog.global. module$node_modules$$pixi$spritesheet$lib$Spritesheet=shadow.js.require(381, {});
