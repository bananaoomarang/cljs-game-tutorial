shadow$provide[366]=function(r,l,A,p){function k(t,u){let v=!1;if(t?._textures?.length)for(let x=0;x<t._textures.length;x++)if(t._textures[x]instanceof g.Texture){const z=t._textures[x].baseTexture;u.includes(z)||(u.push(z),v=!0)}return v}function m(t,u){return t.baseTexture instanceof g.BaseTexture?(t=t.baseTexture,u.includes(t)||u.push(t),!0):!1}function d(t,u){return t._texture&&t._texture instanceof g.Texture?(t=t._texture.baseTexture,u.includes(t)||u.push(t),!0):!1}function c(t,u){return u instanceof
h.Text?(u.updateText(!0),!0):!1}function a(t,u){return u instanceof h.TextStyle?(t=u.toFontString(),h.TextMetrics.measureFont(t),!0):!1}function b(t,u){return t instanceof h.Text?(u.includes(t.style)||u.push(t.style),u.includes(t)||u.push(t),t=t._texture.baseTexture,u.includes(t)||u.push(t),!0):!1}function e(t,u){return t instanceof h.TextStyle?(u.includes(t)||u.push(t),!0):!1}var g=l(209),f=l(214),h=l(364),n=l(365);const q=class{constructor(t){this.limiter=new n.CountLimiter(q.uploadsPerFrame);this.renderer=
t;this.uploadHookHelper=null;this.queue=[];this.addHooks=[];this.uploadHooks=[];this.completes=[];this.ticking=!1;this.delayedTick=()=>{this.queue&&this.prepareItems()};this.registerFindHook(b);this.registerFindHook(e);this.registerFindHook(k);this.registerFindHook(m);this.registerFindHook(d);this.registerUploadHook(c);this.registerUploadHook(a)}upload(t){return new Promise(u=>{t&&this.add(t);this.queue.length?(this.completes.push(u),this.ticking||(this.ticking=!0,g.Ticker.system.addOnce(this.tick,
this,g.UPDATE_PRIORITY.UTILITY))):u()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0];let u=!1;if(t&&!t._destroyed)for(let v=0,x=this.uploadHooks.length;v<x;v++)if(this.uploadHooks[v](this.uploadHookHelper,t)){this.queue.shift();u=!0;break}u||this.queue.shift()}if(this.queue.length)g.Ticker.system.addOnce(this.tick,this,g.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;t=this.completes.slice(0);
this.completes.length=0;for(let u=0,v=t.length;u<v;u++)t[u]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let u=0,v=this.addHooks.length;u<v&&!this.addHooks[u](t,this.queue);u++);if(t instanceof f.Container)for(let u=t.children.length-1;0<=u;u--)this.add(t.children[u]);return this}destroy(){this.ticking&&g.Ticker.system.remove(this.tick,this);this.ticking=!1;this.uploadHookHelper=this.limiter=this.queue=this.completes=
this.renderer=this.uploadHooks=this.addHooks=null}};r=q;r.uploadsPerFrame=4;p.BasePrepare=r}
goog.provide("module$node_modules$$pixi$prepare$lib$BasePrepare");
goog.global. module$node_modules$$pixi$prepare$lib$BasePrepare=shadow.js.require(366, {});
