shadow$provide[254]=function(r,l,A,p){var k=l(209);r=l(214);var m=l(252);l=l(253);r.DisplayObject.mixin(l.accessibleTarget);class d{constructor(c){this._isMobileAccessibility=this._isActive=this.debug=!1;this.pool=[];this.renderId=0;this.children=[];this.androidUpdateCount=0;this.androidUpdateFrequency=500;this._hookDiv=null;(k.utils.isMobile.tablet||k.utils.isMobile.phone)&&this.createTouchHook();const a=document.createElement("div");a.style.width="100px";a.style.height="100px";a.style.position=
"absolute";a.style.top="0px";a.style.left="0px";a.style.zIndex=(2).toString();this.div=a;this.renderer=c;this._onKeyDown=this._onKeyDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const c=document.createElement("button");c.style.width="1px";c.style.height="1px";c.style.position="absolute";c.style.top="-1000px";
c.style.left="-1000px";c.style.zIndex=(2).toString();c.style.backgroundColor="#FF0000";c.title="select to enable accessibility for this content";c.addEventListener("focus",()=>{this._isMobileAccessibility=!0;this.activate();this.destroyTouchHook()});document.body.appendChild(c);this._hookDiv=c}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,
!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(c){if(c.visible&&
c.accessibleChildren&&(c.accessible&&c.isInteractive()&&(c._accessibleActive||this.addChild(c),c.renderId=this.renderId),c=c.children))for(let a=0;a<c.length;a++)this.updateAccessibleObjects(c[a])}update(){var c=performance.now();if(!(k.utils.isMobile.android.device&&c<this.androidUpdateCount)&&(this.androidUpdateCount=c+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);var {x:a,y:b,width:e,
height:g}=this.renderer.view.getBoundingClientRect(),{width:f,height:h,resolution:n}=this.renderer;c=e/f*n;var q=g/h*n,t=this.div;t.style.left=`${a}px`;t.style.top=`${b}px`;t.style.width=`${f}px`;t.style.height=`${h}px`;for(let u=0;u<this.children.length;u++){const v=this.children[u];if(v.renderId!==this.renderId)v._accessibleActive=!1,k.utils.removeItems(this.children,u,1),this.div.removeChild(v._accessibleDiv),this.pool.push(v._accessibleDiv),v._accessibleDiv=null,u--;else{t=v._accessibleDiv;let x=
v.hitArea;const z=v.worldTransform;v.hitArea?(t.style.left=`${(z.tx+x.x*z.a)*c}px`,t.style.top=`${(z.ty+x.y*z.d)*q}px`,t.style.width=`${x.width*z.a*c}px`,t.style.height=`${x.height*z.d*q}px`):(x=v.getBounds(),this.capHitArea(x),t.style.left=`${x.x*c}px`,t.style.top=`${x.y*q}px`,t.style.width=`${x.width*c}px`,t.style.height=`${x.height*q}px`,t.title!==v.accessibleTitle&&null!==v.accessibleTitle&&(t.title=v.accessibleTitle),t.getAttribute("aria-label")!==v.accessibleHint&&null!==v.accessibleHint&&t.setAttribute("aria-label",
v.accessibleHint));(v.accessibleTitle!==t.title||v.tabIndex!==t.tabIndex)&&(t.title=v.accessibleTitle,t.tabIndex=v.tabIndex,this.debug&&this.updateDebugHTML(t))}}this.renderId++}}updateDebugHTML(c){c.innerHTML=`type: ${c.type}</br> title : ${c.title}</br> tabIndex: ${c.tabIndex}`}capHitArea(c){0>c.x&&(c.width+=c.x,c.x=0);0>c.y&&(c.height+=c.y,c.y=0);const {width:a,height:b}=this.renderer;c.x+c.width>a&&(c.width=a-c.x);c.y+c.height>b&&(c.height=b-c.y)}addChild(c){let a=this.pool.pop();a||(a=document.createElement("button"),
a.style.width="100px",a.style.height="100px",a.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",a.style.position="absolute",a.style.zIndex=(2).toString(),a.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?a.setAttribute("aria-live","off"):a.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?a.setAttribute("aria-relevant","additions"):a.setAttribute("aria-relevant","text"),a.addEventListener("click",this._onClick.bind(this)),
a.addEventListener("focus",this._onFocus.bind(this)),a.addEventListener("focusout",this._onFocusOut.bind(this)));a.style.pointerEvents=c.accessiblePointerEvents;a.type=c.accessibleType;c.accessibleTitle&&null!==c.accessibleTitle?a.title=c.accessibleTitle:c.accessibleHint&&null!==c.accessibleHint||(a.title=`displayObject ${c.tabIndex}`);c.accessibleHint&&null!==c.accessibleHint&&a.setAttribute("aria-label",c.accessibleHint);this.debug&&this.updateDebugHTML(a);c._accessibleActive=!0;c._accessibleDiv=
a;a.displayObject=c;this.children.push(c);this.div.appendChild(c._accessibleDiv);c._accessibleDiv.tabIndex=c.tabIndex}_dispatchEvent(c,a){({displayObject:c}=c.target);const b=this.renderer.events.rootBoundary,e=Object.assign(new m.FederatedEvent(b),{target:c});b.rootTarget=this.renderer.lastObjectRendered;a.forEach(g=>b.dispatchEvent(e,g))}_onClick(c){this._dispatchEvent(c,["click","pointertap","tap"])}_onFocus(c){c.target.getAttribute("aria-live")||c.target.setAttribute("aria-live","assertive");
this._dispatchEvent(c,["mouseover"])}_onFocusOut(c){c.target.getAttribute("aria-live")||c.target.setAttribute("aria-live","polite");this._dispatchEvent(c,["mouseout"])}_onKeyDown(c){9===c.keyCode&&this.activate()}_onMouseMove(c){0===c.movementX&&0===c.movementY||this.deactivate()}destroy(){this.destroyTouchHook();this.div=null;globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0);globalThis.removeEventListener("keydown",this._onKeyDown);this.renderer=this.children=this.pool=null}}
d.extension={name:"accessibility",type:[k.ExtensionType.RendererPlugin,k.ExtensionType.CanvasRendererPlugin]};k.extensions.add(d);p.AccessibilityManager=d}
goog.provide("module$node_modules$$pixi$accessibility$lib$AccessibilityManager");
goog.global. module$node_modules$$pixi$accessibility$lib$AccessibilityManager=shadow.js.require(254, {});
