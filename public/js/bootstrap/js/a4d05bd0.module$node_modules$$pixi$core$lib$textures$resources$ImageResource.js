shadow$provide[137]=function(r,l,A,p){var k=l(0),m=l(8),d=l(136);class c extends d.BaseImageResource{constructor(a,b){if(b=b||{},"string"==typeof a){const e=new Image;d.BaseImageResource.crossOrigin(e,a,b.crossorigin);e.src=a;a=e}super(a);!a.complete&&this._width&&this._height&&(this._width=0,this._height=0);this.url=a.src;this._process=null;this.preserveBitmap=!1;this.createBitmap=(b.createBitmap??m.settings.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap;this.alphaMode="number"==typeof b.alphaMode?
b.alphaMode:null;this._load=this.bitmap=null;!1!==b.autoLoad&&this.load()}load(a){return this._load?this._load:(void 0!==a&&(this.createBitmap=a),this._load=new Promise((b,e)=>{const g=this.source;this.url=g.src;const f=()=>{this.destroyed||(g.onload=null,g.onerror=null,this.update(),this._load=null,this.createBitmap?b(this.process()):b(this))};g.complete&&g.src?f():(g.onload=f,g.onerror=h=>{e(h);this.onError.emit(h)})}),this._load)}process(){const a=this.source;if(null!==this._process)return this._process;
if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const b=globalThis.createImageBitmap;return this._process=fetch(a.src,{mode:a.crossOrigin&&"anonymous"!==a.crossOrigin?"no-cors":"cors"}).then(e=>e.blob()).then(e=>b(e,0,0,a.width,a.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===k.ALPHA_MODES.UNPACK?"premultiply":"none"})).then(e=>this.destroyed?Promise.reject():(this.bitmap=e,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(a,
b,e){if("number"==typeof this.alphaMode&&(b.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(a,b,e);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(a,b,e,this.bitmap),!this.preserveBitmap){a=!0;const g=b._glTextures;for(const f in g){const h=g[f];if(h!==e&&h.dirtyId!==b.dirtyId){a=!1;break}}a&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null;this.source.onerror=null;super.dispose();this.bitmap&&(this.bitmap.close(),
this.bitmap=null);this._load=this._process=null}static test(a){return"u">typeof HTMLImageElement&&("string"==typeof a||a instanceof HTMLImageElement)}}p.ImageResource=c}
goog.provide("module$node_modules$$pixi$core$lib$textures$resources$ImageResource");
goog.global. module$node_modules$$pixi$core$lib$textures$resources$ImageResource=shadow.js.require(137, {});
